package builtin

import (
	"github.com/stretchr/testify/assert"
	"testing"
)

func TestFileStorageContract_UploadFile(t *testing.T) {
	contract := NewFileStorageContract()
	data, err := contract.UploadFile("zltc_dhdfbm9JEoyDvYoCDVsABiZj52TAo9Ei6", "/root/home", "zltc_dhdfbm9JEoyDvYoCDVsABiZj52TAo9Ei6", "/root/home/tmp", 1024, "10086")
	assert.NoError(t, err)
	expectData := "0x6a8dcce90000000000000000000000009293c604c644bfac34f498998cc3402f203d4d6b00000000000000000000000000000000000000000000000000000000000000c00000000000000000000000009293c604c644bfac34f498998cc3402f203d4d6b000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000000a2f726f6f742f686f6d6500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e2f726f6f742f686f6d652f746d7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000053130303836000000000000000000000000000000000000000000000000000000"
	assert.Equal(t, expectData, data)
}

func TestFileStorageContract_UpdatePermission(t *testing.T) {
	contract := NewFileStorageContract()
	data, err := contract.UpdatePermission("zltc_dhdfbm9JEoyDvYoCDVsABiZj52TAo9Ei6", "zltc_dhdfbm9JEoyDvYoCDVsABiZj52TAo9Ei6", 1024)
	assert.NoError(t, err)
	expectData := "0x21171b260000000000000000000000009293c604c644bfac34f498998cc3402f203d4d6b0000000000000000000000009293c604c644bfac34f498998cc3402f203d4d6b0000000000000000000000000000000000000000000000000000000000000400"
	assert.Equal(t, expectData, data)
}

func TestFileStorageContract_DownloadFile(t *testing.T) {
	contract := NewFileStorageContract()
	data, err := contract.DownloadFile("zltc_dhdfbm9JEoyDvYoCDVsABiZj52TAo9Ei6", "10086")
	assert.NoError(t, err)
	expectData := "0x01b9bfd60000000000000000000000009293c604c644bfac34f498998cc3402f203d4d6b000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000053130303836000000000000000000000000000000000000000000000000000000"
	assert.Equal(t, expectData, data)
}
